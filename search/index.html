---
permalink: /search/
layout: page
title: Search
---


<script>
  //<![CDATA[

  var urlParams = new URLSearchParams(window.location.search);
  var searchEndpoint = new URL("{{site.searchgov.endpoint}}/api/v2/search/i14y");
  var query = urlParams.get('query');
  params = { affiliate: "{{site.searchgov.affiliate}}", access_key: "{{site.searchgov.access_key}}", query: query }


  Object.keys(params).forEach(key => searchEndpoint.searchParams.append(key, params[key]))

  fetch(searchEndpoint).then(function (response) {
    return response.json()
  }).then(function (posts) {
    for (item in posts.web.results) {
      render_result(`
          <li>
            <a href="${posts.web.results[item]['url']}">
              <h2 class="title">${posts.web.results[item]['title']}</h2>
              <p> ${posts.web.results[item]['snippet'].replace(/\uE000/g, '<span class="bg-yellow">').replace(/\uE001/g, '</span>')}... <span class="read-more">Continue reading<span class="usa-sr-only"> this article</span> </p>
            </a>
          </li>
          `, true)

    }
  }).catch(function (ex) {
    console.log('parsing failed', ex);
  }).finally(function (e) {

    if (document.getElementById('search-results').childNodes.length == 0) {
      render_result(`<h4 class="title">No results found</h4>`, false)
    }

  })

  function render_result(content, append = true) {
    const previous = document.getElementById('search-results').innerHTML;
    document.getElementById('search-results').innerHTML = (append == true) ? previous + content : content;
  }

//]]>
</script>


{% if site.searchgov %}
<h1>Search Results</h1>
<ol id="search-results"></ol>
{% else %}
<script>
  window.location = "/";
</script>
{% endif %}