---
permalink: /search/
layout: page
title: Search
sitemap: false
---


<script>
  (() => {
    const renderResults = (query, results, routedFrom) => {
      const element = document.getElementById('search-results');
      element.innerHTML = '';

      if (routedFrom) {
        element.innerHTML += `
          <h2 class="title">We’re sorry! We found 0 results for “${routedFrom}.”</h2>
          <h2 class="title">However, we found results for the related term “${query}.”</h2>
        `;
      }

      if (!results.length) {
        element.innerHTML += `<h2 class="title">No results found</h2>`;
      }
      else {
        element.innerHTML += `
          <ol>
            ${results.map(renderResults_result).join('')}
          </ol>
        `;
      }
    };

    const continueReading = (result) => {
      if (result.description) {
        return `... <span class="read-more">Continue reading</span>`;
      }
      return '';
    }

    const renderResults_result = (result) => {
      return `
        <li>
          <a href="${result.url}">
            <h2 class="title">${highlight(result.title)}</h2>
            <p>${highlight(result.description)}${continueReading(result)}</p>
          </a>
        </li>
      `;
    };

    const highlight = (text) => {
      // Don't highlight text on routed search URLs
      if (routedFrom) {
        return text;
      }
      return text.replace(/\uE000/g, '<span class="bg-yellow">').replace(/\uE001/g, '</span>');
    };

    const searchParams = new URLSearchParams(window.location.search);
    const query = searchParams.get('query');
    const routedFrom = searchParams.get('source');

    window.addEventListener('DOMContentLoaded', () => {
      const highlightSearchTerms = !routedFrom;
      window.SearchService(query, highlightSearchTerms).then((response) => {
        if (response.routeTo) {
          window.location.replace(response.routeTo);
        }
        else {
          renderResults(query, response.results, routedFrom);
        }
      });
    });
  })();
</script>

<h1>Search Results</h1>

<div id="search-results">Loading…</div>
